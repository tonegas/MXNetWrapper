(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     37196,        870]
NotebookOptionsPosition[     34729,        817]
NotebookOutlinePosition[     35101,        833]
CellTagsIndexPosition[     35058,        830]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[
 RowBox[{"SetDirectory", "[", 
  RowBox[{"NotebookDirectory", "[", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.747910598912767*^9, 
  3.7479106228116627`*^9}},ExpressionUUID->"7f264ccd-6af5-4524-92b6-\
06c9f762a2cd"],

Cell[BoxData["\<\"/home/tonegas/Work/Dreams4Cars/repositories/MXNetWrapper/\
networks\"\>"], "Output",
 CellChangeTimes->{
  3.747910624547842*^9},ExpressionUUID->"c8f5b66e-799d-469a-91dd-\
b4bae809a666"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Clear", "@", "netRaw"}], "\[IndentingNewLine]", 
 RowBox[{"netRaw", "=", 
  RowBox[{"NetGraph", "[", 
   RowBox[{
    RowBox[{"<|", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\"\<trIn\>\"", "\[Rule]", " ", 
       RowBox[{"DropoutLayer", "[", "0.01", "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<trW1\>\"", "\[Rule]", " ", 
       RowBox[{"NetInitialize", "@", 
        RowBox[{"LinearLayer", "[", 
         RowBox[{"1", ",", 
          RowBox[{"\"\<Input\>\"", "\[Rule]", "5"}], ",", 
          RowBox[{"\"\<Weights\>\"", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"Table", "[", 
             RowBox[{"0.01", ",", 
              RowBox[{"{", "5", "}"}]}], "]"}], "}"}]}], ",", 
          RowBox[{"\"\<Biases\>\"", "\[Rule]", 
           RowBox[{"{", "0.1", "}"}]}]}], "]"}]}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<trOut\>\"", "\[Rule]", " ", "Ramp"}]}], 
     "\[IndentingNewLine]", "|>"}], ",", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"NetPort", "[", "\"\<throttle\>\"", "]"}], "\[Rule]", 
      RowBox[{"\"\<trIn\>\"", "\[Rule]", " ", 
       RowBox[{"\"\<trW1\>\"", "\[Rule]", " ", 
        RowBox[{"\"\<trOut\>\"", "\[Rule]", "  ", 
         RowBox[{"NetPort", "[", "\"\<acc\>\"", "]"}]}]}]}]}], 
     "\[IndentingNewLine]", "}"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.747912067980342*^9, 
  3.747912098387107*^9}},ExpressionUUID->"7de80479-82aa-42b9-9f44-\
979d430f65ad"],

Cell[BoxData[
 StyleBox[
  TagBox[
   TagBox[
    RowBox[{"NetGraph", 
     RowBox[{"[", 
      PanelBox[
       DynamicModuleBox[{NeuralNetworks`Private`NetGraph`selection = None}, 
        DynamicBox[GridBox[
          Map[List, {
            ToBoxes[
             
             NeuralNetworks`Private`NetGraph`netLayerPlot[{{1, 2}, {2, 3}, {3,
               4}, {4, 5}}, 
              Dynamic[NeuralNetworks`Private`NetGraph`selection], False, {
              "throttle", "trIn", "trW1", "trOut", "acc"}, {Null, 
               RGBColor[0.96, 0.15999999999999992`, 0.15999999999999992`], 
               GrayLevel[0.4], 
               RGBColor[0.29, 0.29, 0.83]}, {1, 2, 3, 4, 1}, {
              Null, DropoutLayer, LinearLayer, Ramp}, {
               NeuralNetworks`TensorT[{5}, NeuralNetworks`RealT], 
               NeuralNetworks`TensorT[{5}, NeuralNetworks`RealT], 
               NeuralNetworks`TensorT[{1}, NeuralNetworks`RealT], 
               NeuralNetworks`TensorT[{1}, NeuralNetworks`RealT]}, None]], 
            If[
             IntegerQ[NeuralNetworks`Private`NetGraph`selection], 
             ItemBox[
              NeuralNetworks`Private`NetGraph`vpathInfo[
               Part[{
                 NeuralNetworks`NetPath["Inputs", "throttle"], 
                 NeuralNetworks`NetPath["Nodes", "trIn"], 
                 NeuralNetworks`NetPath["Nodes", "trW1"], 
                 NeuralNetworks`NetPath["Nodes", "trOut"], 
                 NeuralNetworks`NetPath["Outputs", "acc"]}, 
                NeuralNetworks`Private`NetGraph`selection], 
               Association[
               "throttle" -> 
                NeuralNetworks`TensorT[{5}, NeuralNetworks`RealT]], 
               Association[
               "acc" -> NeuralNetworks`TensorT[{1}, NeuralNetworks`RealT]], 
               Association[
               "trIn" -> Association[
                 "Type" -> "Dropout", "Arrays" -> Association[], "Parameters" -> 
                  Association[
                   "DropoutProbability" -> 0.01, "Method" -> "Dropout"], 
                  "Inputs" -> 
                  Association[
                   "Input" -> 
                    NeuralNetworks`TensorT[{5}, NeuralNetworks`RealT]], 
                  "Outputs" -> 
                  Association[
                   "Output" -> 
                    NeuralNetworks`TensorT[{5}, NeuralNetworks`RealT]]], 
                "trW1" -> Association[
                 "Type" -> "Linear", "Arrays" -> 
                  Association[
                   "Weights" -> NeuralNetworks`Private`DummyRawArray[{1, 5}], 
                    "Biases" -> NeuralNetworks`Private`DummyRawArray[{1}]], 
                  "Parameters" -> 
                  Association[
                   "OutputDimensions" -> {1}, "$OutputSize" -> 1, 
                    "$InputSize" -> 5, "$InputDimensions" -> {5}], "Inputs" -> 
                  Association[
                   "Input" -> 
                    NeuralNetworks`TensorT[{5}, NeuralNetworks`RealT]], 
                  "Outputs" -> 
                  Association[
                   "Output" -> 
                    NeuralNetworks`TensorT[{1}, NeuralNetworks`RealT]]], 
                "trOut" -> 
                Association[
                 "Type" -> "Elementwise", "Arrays" -> Association[], 
                  "Parameters" -> 
                  Association[
                   "Function" -> NeuralNetworks`ValidatedParameter[Ramp], 
                    "$Dimensions" -> {1}], "Inputs" -> 
                  Association[
                   "Input" -> 
                    NeuralNetworks`TensorT[{1}, NeuralNetworks`RealT]], 
                  "Outputs" -> 
                  Association[
                   "Output" -> 
                    NeuralNetworks`TensorT[{1}, NeuralNetworks`RealT]]]]], 
              Alignment -> Center], Nothing]}], 
          GridBoxAlignment -> {"Columns" -> {{Left}}}],
         ImageSizeCache->{596., {83.5, 92.5}},
         TrackedSymbols:>{NeuralNetworks`Private`NetGraph`selection}],
        Initialization:>{NetGraph}],
       BaselinePosition->(Top -> Scaled[3])], "]"}]}],
    False],
   Deploy],
  LineBreakWithin->False]], "Output",
 CellChangeTimes->{{3.747912094707885*^9, 
  3.747912098866724*^9}},ExpressionUUID->"81cafb01-31c3-4593-9ec2-\
0b2df40bcc1b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"netRaw", "[", 
  RowBox[{"<|", 
   RowBox[{"\"\<throttle\>\"", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "2", ",", "3", ",", "4", ",", "5"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "2", ",", "3", ",", "4", ",", "6"}], "}"}]}], 
     "}"}]}], "|>"}], "]"}]], "Input",
 CellChangeTimes->{
  3.747912112634555*^9, {3.747912374220265*^9, 
   3.7479123803056393`*^9}},ExpressionUUID->"ba4d8133-5eb1-4120-8afc-\
4257c98f0cf8"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", "0.25`", "}"}], ",", 
   RowBox[{"{", "0.25999999046325684`", "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.747912113623658*^9, 
  3.747912381209755*^9},ExpressionUUID->"961c4c1d-ef7e-459e-be4e-\
4a6f557e7410"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MXNetNetworkExport", "[", 
  RowBox[{"netRaw", ",", "\"\<netTest1\>\""}], "]"}]], "Input",
 CellChangeTimes->{
  3.747912121671166*^9, {3.747913461885787*^9, 
   3.747913467058168*^9}},ExpressionUUID->"a8d69a2d-d66a-42dd-9c7d-\
d9330ce4d24e"],

Cell[BoxData["\<\"netTest1-0000.params\"\>"], "Output",
 CellChangeTimes->{3.74791212310839*^9, 
  3.7479134688185387`*^9},ExpressionUUID->"7403f651-7367-46a2-a978-\
32a05ab3dffd"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Clear", "@", "netRaw"}], "\[IndentingNewLine]", 
 RowBox[{"netRaw", "=", 
  RowBox[{"NetGraph", "[", 
   RowBox[{
    RowBox[{"<|", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\"\<trIn\>\"", "\[Rule]", " ", 
       RowBox[{"DropoutLayer", "[", "0.01", "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<trW1\>\"", "\[Rule]", " ", 
       RowBox[{"NetInitialize", "@", 
        RowBox[{"LinearLayer", "[", 
         RowBox[{"1", ",", 
          RowBox[{"\"\<Input\>\"", "\[Rule]", "5"}], ",", 
          RowBox[{"\"\<Weights\>\"", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"Table", "[", 
             RowBox[{"0.01", ",", 
              RowBox[{"{", "5", "}"}]}], "]"}], "}"}]}], ",", 
          RowBox[{"\"\<Biases\>\"", "\[Rule]", 
           RowBox[{"{", "0.1", "}"}]}]}], "]"}]}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<trOut\>\"", "\[Rule]", " ", "Ramp"}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"\"\<brIn\>\"", "\[Rule]", " ", 
       RowBox[{"DropoutLayer", "[", "0.01", "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<brW1\>\"", "\[Rule]", 
       RowBox[{"NetInitialize", "@", 
        RowBox[{"LinearLayer", "[", 
         RowBox[{"1", ",", 
          RowBox[{"\"\<Input\>\"", "\[Rule]", "5"}], ",", 
          RowBox[{"\"\<Weights\>\"", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"Table", "[", 
             RowBox[{"0.01", ",", 
              RowBox[{"{", "5", "}"}]}], "]"}], "}"}]}], ",", 
          RowBox[{"\"\<Biases\>\"", "\[Rule]", 
           RowBox[{"{", "0.1", "}"}]}]}], "]"}]}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<brOut\>\"", "\[Rule]", " ", "Ramp"}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"\"\<out\>\"", "\[Rule]", " ", 
       RowBox[{"ThreadingLayer", "[", "Plus", "]"}]}]}], 
     "\[IndentingNewLine]", "|>"}], ",", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"NetPort", "[", "\"\<brake\>\"", "]"}], " ", "\[Rule]", " ", 
       RowBox[{"\"\<brIn\>\"", "\[Rule]", 
        RowBox[{"\"\<brW1\>\"", "\[Rule]", "\"\<brOut\>\""}]}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"NetPort", "[", "\"\<throttle\>\"", "]"}], "\[Rule]", 
       RowBox[{"\"\<trIn\>\"", "\[Rule]", " ", 
        RowBox[{"\"\<trW1\>\"", "\[Rule]", " ", "\"\<trOut\>\""}]}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\"\<brOut\>\"", ",", "\"\<trOut\>\""}], "}"}], "\[Rule]", 
       "  ", 
       RowBox[{"\"\<out\>\"", "\[Rule]", "  ", 
        RowBox[{"NetPort", "[", "\"\<acc\>\"", "]"}]}]}]}], 
     "\[IndentingNewLine]", "}"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.7479093790887003`*^9, 3.747909459775836*^9}, {
  3.747909635428883*^9, 
  3.747909683850235*^9}},ExpressionUUID->"153de193-f99a-4bec-af71-\
8e49894afc52"],

Cell[BoxData[
 StyleBox[
  TagBox[
   TagBox[
    RowBox[{"NetGraph", 
     RowBox[{"[", 
      PanelBox[
       DynamicModuleBox[{NeuralNetworks`Private`NetGraph`selection = None}, 
        DynamicBox[GridBox[
          Map[List, {
            ToBoxes[
             
             NeuralNetworks`Private`NetGraph`netLayerPlot[{{1, 2}, {2, 3}, {3,
               4}, {5, 6}, {6, 7}, {7, 8}, {4, 9}, {8, 9}, {9, 10}}, 
              Dynamic[NeuralNetworks`Private`NetGraph`selection], False, {
              "brake", "brIn", "brW1", "brOut", "throttle", "trIn", "trW1", 
               "trOut", "out", "acc"}, {Null, 
               RGBColor[0.96, 0.15999999999999992`, 0.15999999999999992`], 
               GrayLevel[0.4], 
               RGBColor[0.29, 0.29, 0.83], 
               RGBColor[0.01, 0.54, 0.67]}, {1, 2, 3, 4, 1, 2, 3, 4, 5, 1}, {
              Null, DropoutLayer, LinearLayer, Ramp, Plus}, {
               NeuralNetworks`TensorT[{5}, NeuralNetworks`RealT], 
               NeuralNetworks`TensorT[{5}, NeuralNetworks`RealT], 
               NeuralNetworks`TensorT[{1}, NeuralNetworks`RealT], 
               NeuralNetworks`TensorT[{5}, NeuralNetworks`RealT], 
               NeuralNetworks`TensorT[{5}, NeuralNetworks`RealT], 
               NeuralNetworks`TensorT[{1}, NeuralNetworks`RealT], 
               NeuralNetworks`TensorT[{1}, NeuralNetworks`RealT], 
               NeuralNetworks`TensorT[{1}, NeuralNetworks`RealT], 
               NeuralNetworks`TensorT[{1}, NeuralNetworks`RealT]}, None]], 
            If[
             IntegerQ[NeuralNetworks`Private`NetGraph`selection], 
             ItemBox[
              NeuralNetworks`Private`NetGraph`vpathInfo[
               Part[{
                 NeuralNetworks`NetPath["Inputs", "brake"], 
                 NeuralNetworks`NetPath["Nodes", "brIn"], 
                 NeuralNetworks`NetPath["Nodes", "brW1"], 
                 NeuralNetworks`NetPath["Nodes", "brOut"], 
                 NeuralNetworks`NetPath["Inputs", "throttle"], 
                 NeuralNetworks`NetPath["Nodes", "trIn"], 
                 NeuralNetworks`NetPath["Nodes", "trW1"], 
                 NeuralNetworks`NetPath["Nodes", "trOut"], 
                 NeuralNetworks`NetPath["Nodes", "out"], 
                 NeuralNetworks`NetPath["Outputs", "acc"]}, 
                NeuralNetworks`Private`NetGraph`selection], 
               Association[
               "brake" -> NeuralNetworks`TensorT[{5}, NeuralNetworks`RealT], 
                "throttle" -> 
                NeuralNetworks`TensorT[{5}, NeuralNetworks`RealT]], 
               Association[
               "acc" -> NeuralNetworks`TensorT[{1}, NeuralNetworks`RealT]], 
               Association[
               "brIn" -> Association[
                 "Type" -> "Dropout", "Arrays" -> Association[], "Parameters" -> 
                  Association[
                   "DropoutProbability" -> 0.01, "Method" -> "Dropout"], 
                  "Inputs" -> 
                  Association[
                   "Input" -> 
                    NeuralNetworks`TensorT[{5}, NeuralNetworks`RealT]], 
                  "Outputs" -> 
                  Association[
                   "Output" -> 
                    NeuralNetworks`TensorT[{5}, NeuralNetworks`RealT]]], 
                "brW1" -> Association[
                 "Type" -> "Linear", "Arrays" -> 
                  Association[
                   "Weights" -> NeuralNetworks`Private`DummyRawArray[{1, 5}], 
                    "Biases" -> NeuralNetworks`Private`DummyRawArray[{1}]], 
                  "Parameters" -> 
                  Association[
                   "OutputDimensions" -> {1}, "$OutputSize" -> 1, 
                    "$InputSize" -> 5, "$InputDimensions" -> {5}], "Inputs" -> 
                  Association[
                   "Input" -> 
                    NeuralNetworks`TensorT[{5}, NeuralNetworks`RealT]], 
                  "Outputs" -> 
                  Association[
                   "Output" -> 
                    NeuralNetworks`TensorT[{1}, NeuralNetworks`RealT]]], 
                "brOut" -> 
                Association[
                 "Type" -> "Elementwise", "Arrays" -> Association[], 
                  "Parameters" -> 
                  Association[
                   "Function" -> NeuralNetworks`ValidatedParameter[Ramp], 
                    "$Dimensions" -> {1}], "Inputs" -> 
                  Association[
                   "Input" -> 
                    NeuralNetworks`TensorT[{1}, NeuralNetworks`RealT]], 
                  "Outputs" -> 
                  Association[
                   "Output" -> 
                    NeuralNetworks`TensorT[{1}, NeuralNetworks`RealT]]], 
                "trIn" -> Association[
                 "Type" -> "Dropout", "Arrays" -> Association[], "Parameters" -> 
                  Association[
                   "DropoutProbability" -> 0.01, "Method" -> "Dropout"], 
                  "Inputs" -> 
                  Association[
                   "Input" -> 
                    NeuralNetworks`TensorT[{5}, NeuralNetworks`RealT]], 
                  "Outputs" -> 
                  Association[
                   "Output" -> 
                    NeuralNetworks`TensorT[{5}, NeuralNetworks`RealT]]], 
                "trW1" -> Association[
                 "Type" -> "Linear", "Arrays" -> 
                  Association[
                   "Weights" -> NeuralNetworks`Private`DummyRawArray[{1, 5}], 
                    "Biases" -> NeuralNetworks`Private`DummyRawArray[{1}]], 
                  "Parameters" -> 
                  Association[
                   "OutputDimensions" -> {1}, "$OutputSize" -> 1, 
                    "$InputSize" -> 5, "$InputDimensions" -> {5}], "Inputs" -> 
                  Association[
                   "Input" -> 
                    NeuralNetworks`TensorT[{5}, NeuralNetworks`RealT]], 
                  "Outputs" -> 
                  Association[
                   "Output" -> 
                    NeuralNetworks`TensorT[{1}, NeuralNetworks`RealT]]], 
                "trOut" -> 
                Association[
                 "Type" -> "Elementwise", "Arrays" -> Association[], 
                  "Parameters" -> 
                  Association[
                   "Function" -> NeuralNetworks`ValidatedParameter[Ramp], 
                    "$Dimensions" -> {1}], "Inputs" -> 
                  Association[
                   "Input" -> 
                    NeuralNetworks`TensorT[{1}, NeuralNetworks`RealT]], 
                  "Outputs" -> 
                  Association[
                   "Output" -> 
                    NeuralNetworks`TensorT[{1}, NeuralNetworks`RealT]]], 
                "out" -> Association[
                 "Type" -> "Threading", "Arrays" -> Association[], 
                  "Parameters" -> 
                  Association[
                   "Function" -> NeuralNetworks`ValidatedParameter[Plus], 
                    "$Dimensions" -> {1}], "Inputs" -> Association["Input" -> {
                    NeuralNetworks`TensorT[{1}, NeuralNetworks`RealT], 
                    NeuralNetworks`TensorT[{1}, NeuralNetworks`RealT]}], 
                  "Outputs" -> 
                  Association[
                   "Output" -> 
                    NeuralNetworks`TensorT[{1}, NeuralNetworks`RealT]]]]], 
              Alignment -> Center], Nothing]}], 
          GridBoxAlignment -> {"Columns" -> {{Left}}}],
         ImageSizeCache->{724., {147.5, 156.5}},
         TrackedSymbols:>{NeuralNetworks`Private`NetGraph`selection}],
        Initialization:>{NetGraph}],
       BaselinePosition->(Top -> Scaled[3])], "]"}]}],
    False],
   Deploy],
  LineBreakWithin->False]], "Output",
 CellChangeTimes->{3.747909686432081*^9, 3.7479100438883743`*^9, 
  3.747913472317124*^9, 
  3.747918142525296*^9},ExpressionUUID->"f54de7d7-477b-472c-b92e-\
c28fa3f6c966"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"netRaw", "[", 
  RowBox[{"<|", 
   RowBox[{
    RowBox[{"\"\<throttle\>\"", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2", ",", "3", ",", "4", ",", "5"}], "}"}]}], ",", 
    RowBox[{"\"\<brake\>\"", "\[Rule]", " ", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2", ",", "3", ",", "4", ",", "5"}], "}"}]}]}], 
   "|>"}], "]"}]], "Input",
 CellChangeTimes->{{3.747910049438476*^9, 3.7479100958047037`*^9}, {
  3.747910262030534*^9, 3.747910263740399*^9}, {3.747910469224164*^9, 
  3.747910508327752*^9}, {3.747915202648872*^9, 
  3.747915228077724*^9}},ExpressionUUID->"875ef99f-65d9-4272-b6ed-\
6f3dc101224c"],

Cell[BoxData[
 RowBox[{"{", "0.5`", "}"}]], "Output",
 CellChangeTimes->{{3.747910064941145*^9, 3.7479100798226137`*^9}, 
   3.747910509289954*^9, 3.74791347604574*^9, {3.747915199913967*^9, 
   3.747915228871229*^9}, 
   3.747918144838419*^9},ExpressionUUID->"46cb8886-d3dd-4add-9785-\
e782909aea77"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MXNetNetworkExport", "[", 
  RowBox[{"netRaw", ",", "\"\<netTest2\>\""}], "]"}]], "Input",
 CellChangeTimes->{{3.747909706868813*^9, 3.747909724588674*^9}, {
   3.747909896065761*^9, 3.747909901136301*^9}, 3.7479106422047853`*^9, 
   3.747910686273623*^9, {3.74791347907854*^9, 
   3.747913480795909*^9}},ExpressionUUID->"f4da7ec8-05c9-4ca4-bd42-\
497b0b6ada1b"],

Cell[BoxData["\<\"netTest2-0000.params\"\>"], "Output",
 CellChangeTimes->{3.747909901690016*^9, 3.747910547552268*^9, 
  3.747910629288102*^9, 3.747910686852047*^9, 3.747913481326887*^9, 
  3.747918146824435*^9},ExpressionUUID->"b5385f61-501f-4649-94a4-\
86c1a753d488"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Clear", "@", "netRaw"}], "\[IndentingNewLine]", 
 RowBox[{"netRaw", "=", 
  RowBox[{"NetGraph", "[", 
   RowBox[{
    RowBox[{"<|", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\"\<trIn\>\"", "\[Rule]", " ", 
       RowBox[{"DropoutLayer", "[", "0.01", "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<trW1\>\"", "\[Rule]", " ", 
       RowBox[{"NetInitialize", "@", 
        RowBox[{"LinearLayer", "[", 
         RowBox[{"1", ",", 
          RowBox[{"\"\<Input\>\"", "\[Rule]", "5"}], ",", 
          RowBox[{"\"\<Weights\>\"", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"Table", "[", 
             RowBox[{"0.01", ",", 
              RowBox[{"{", "5", "}"}]}], "]"}], "}"}]}], ",", 
          RowBox[{"\"\<Biases\>\"", "\[Rule]", 
           RowBox[{"{", "0.1", "}"}]}]}], "]"}]}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<trOut\>\"", "\[Rule]", " ", "Ramp"}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"\"\<brIn\>\"", "\[Rule]", " ", 
       RowBox[{"DropoutLayer", "[", "0.01", "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<brW1\>\"", "\[Rule]", 
       RowBox[{"NetInitialize", "@", 
        RowBox[{"LinearLayer", "[", 
         RowBox[{"1", ",", 
          RowBox[{"\"\<Input\>\"", "\[Rule]", "5"}], ",", 
          RowBox[{"\"\<Weights\>\"", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"Table", "[", 
             RowBox[{"0.01", ",", 
              RowBox[{"{", "5", "}"}]}], "]"}], "}"}]}], ",", 
          RowBox[{"\"\<Biases\>\"", "\[Rule]", 
           RowBox[{"{", "0.1", "}"}]}]}], "]"}]}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<brOut\>\"", "\[Rule]", " ", "Ramp"}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"\"\<OutW\>\"", "\[Rule]", 
       RowBox[{"NetInitialize", "@", 
        RowBox[{"LinearLayer", "[", 
         RowBox[{"1", ",", 
          RowBox[{"\"\<Input\>\"", "\[Rule]", "1"}], ",", 
          RowBox[{"\"\<Weights\>\"", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"{", "5", "}"}], "}"}]}], ",", 
          RowBox[{"\"\<Biases\>\"", "\[Rule]", 
           RowBox[{"{", "0.1", "}"}]}]}], "]"}]}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<out\>\"", "\[Rule]", " ", 
       RowBox[{"ThreadingLayer", "[", "Plus", "]"}]}]}], 
     "\[IndentingNewLine]", "|>"}], ",", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"NetPort", "[", "\"\<brake\>\"", "]"}], " ", "\[Rule]", " ", 
       RowBox[{"\"\<brIn\>\"", "\[Rule]", 
        RowBox[{"\"\<brW1\>\"", "\[Rule]", "\"\<brOut\>\""}]}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"NetPort", "[", "\"\<throttle\>\"", "]"}], "\[Rule]", 
       RowBox[{"\"\<trIn\>\"", "\[Rule]", " ", 
        RowBox[{"\"\<trW1\>\"", "\[Rule]", " ", "\"\<trOut\>\""}]}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\"\<brOut\>\"", ",", "\"\<trOut\>\""}], "}"}], "\[Rule]", 
       "  ", 
       RowBox[{"\"\<out\>\"", "\[Rule]", "  ", 
        RowBox[{"NetPort", "[", "\"\<acc\>\"", "]"}]}]}], ",", 
      "\[IndentingNewLine]", "  ", 
      RowBox[{"\"\<out\>\"", "\[Rule]", 
       RowBox[{"\"\<OutW\>\"", "\[Rule]", "   ", 
        RowBox[{"NetPort", "[", "\"\<acc1\>\"", "]"}]}]}]}], 
     "\[IndentingNewLine]", "}"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.74791576251075*^9, 3.7479157877464237`*^9}, {
  3.747916452329509*^9, 
  3.747916511639146*^9}},ExpressionUUID->"35171a95-8286-4f5a-8294-\
2e78e6f5d951"],

Cell[BoxData[
 StyleBox[
  TagBox[
   TagBox[
    RowBox[{"NetGraph", 
     RowBox[{"[", 
      PanelBox[
       DynamicModuleBox[{NeuralNetworks`Private`NetGraph`selection = None}, 
        DynamicBox[GridBox[
          Map[List, {
            ToBoxes[
             
             NeuralNetworks`Private`NetGraph`netLayerPlot[{{1, 2}, {2, 3}, {3,
               4}, {5, 6}, {6, 7}, {7, 8}, {4, 9}, {8, 9}, {9, 10}, {9, 11}, {
              11, 12}}, 
              Dynamic[NeuralNetworks`Private`NetGraph`selection], False, {
              "brake", "brIn", "brW1", "brOut", "throttle", "trIn", "trW1", 
               "trOut", "out", "acc", "OutW", "acc1"}, {Null, 
               RGBColor[0.96, 0.15999999999999992`, 0.15999999999999992`], 
               GrayLevel[0.4], 
               RGBColor[0.29, 0.29, 0.83], 
               RGBColor[0.01, 0.54, 0.67]}, {1, 2, 3, 4, 1, 2, 3, 4, 5, 1, 3, 
              1}, {Null, DropoutLayer, LinearLayer, Ramp, Plus}, {
               NeuralNetworks`TensorT[{5}, NeuralNetworks`RealT], 
               NeuralNetworks`TensorT[{5}, NeuralNetworks`RealT], 
               NeuralNetworks`TensorT[{1}, NeuralNetworks`RealT], 
               NeuralNetworks`TensorT[{5}, NeuralNetworks`RealT], 
               NeuralNetworks`TensorT[{5}, NeuralNetworks`RealT], 
               NeuralNetworks`TensorT[{1}, NeuralNetworks`RealT], 
               NeuralNetworks`TensorT[{1}, NeuralNetworks`RealT], 
               NeuralNetworks`TensorT[{1}, NeuralNetworks`RealT], 
               NeuralNetworks`TensorT[{1}, NeuralNetworks`RealT], 
               NeuralNetworks`TensorT[{1}, NeuralNetworks`RealT], 
               NeuralNetworks`TensorT[{1}, NeuralNetworks`RealT]}, None]], 
            If[
             IntegerQ[NeuralNetworks`Private`NetGraph`selection], 
             ItemBox[
              NeuralNetworks`Private`NetGraph`vpathInfo[
               Part[{
                 NeuralNetworks`NetPath["Inputs", "brake"], 
                 NeuralNetworks`NetPath["Nodes", "brIn"], 
                 NeuralNetworks`NetPath["Nodes", "brW1"], 
                 NeuralNetworks`NetPath["Nodes", "brOut"], 
                 NeuralNetworks`NetPath["Inputs", "throttle"], 
                 NeuralNetworks`NetPath["Nodes", "trIn"], 
                 NeuralNetworks`NetPath["Nodes", "trW1"], 
                 NeuralNetworks`NetPath["Nodes", "trOut"], 
                 NeuralNetworks`NetPath["Nodes", "out"], 
                 NeuralNetworks`NetPath["Outputs", "acc"], 
                 NeuralNetworks`NetPath["Nodes", "OutW"], 
                 NeuralNetworks`NetPath["Outputs", "acc1"]}, 
                NeuralNetworks`Private`NetGraph`selection], 
               Association[
               "brake" -> NeuralNetworks`TensorT[{5}, NeuralNetworks`RealT], 
                "throttle" -> 
                NeuralNetworks`TensorT[{5}, NeuralNetworks`RealT]], 
               Association[
               "acc" -> NeuralNetworks`TensorT[{1}, NeuralNetworks`RealT], 
                "acc1" -> NeuralNetworks`TensorT[{1}, NeuralNetworks`RealT]], 
               
               Association[
               "brIn" -> Association[
                 "Type" -> "Dropout", "Arrays" -> Association[], "Parameters" -> 
                  Association[
                   "DropoutProbability" -> 0.01, "Method" -> "Dropout"], 
                  "Inputs" -> 
                  Association[
                   "Input" -> 
                    NeuralNetworks`TensorT[{5}, NeuralNetworks`RealT]], 
                  "Outputs" -> 
                  Association[
                   "Output" -> 
                    NeuralNetworks`TensorT[{5}, NeuralNetworks`RealT]]], 
                "brW1" -> Association[
                 "Type" -> "Linear", "Arrays" -> 
                  Association[
                   "Weights" -> NeuralNetworks`Private`DummyRawArray[{1, 5}], 
                    "Biases" -> NeuralNetworks`Private`DummyRawArray[{1}]], 
                  "Parameters" -> 
                  Association[
                   "OutputDimensions" -> {1}, "$OutputSize" -> 1, 
                    "$InputSize" -> 5, "$InputDimensions" -> {5}], "Inputs" -> 
                  Association[
                   "Input" -> 
                    NeuralNetworks`TensorT[{5}, NeuralNetworks`RealT]], 
                  "Outputs" -> 
                  Association[
                   "Output" -> 
                    NeuralNetworks`TensorT[{1}, NeuralNetworks`RealT]]], 
                "brOut" -> 
                Association[
                 "Type" -> "Elementwise", "Arrays" -> Association[], 
                  "Parameters" -> 
                  Association[
                   "Function" -> NeuralNetworks`ValidatedParameter[Ramp], 
                    "$Dimensions" -> {1}], "Inputs" -> 
                  Association[
                   "Input" -> 
                    NeuralNetworks`TensorT[{1}, NeuralNetworks`RealT]], 
                  "Outputs" -> 
                  Association[
                   "Output" -> 
                    NeuralNetworks`TensorT[{1}, NeuralNetworks`RealT]]], 
                "trIn" -> Association[
                 "Type" -> "Dropout", "Arrays" -> Association[], "Parameters" -> 
                  Association[
                   "DropoutProbability" -> 0.01, "Method" -> "Dropout"], 
                  "Inputs" -> 
                  Association[
                   "Input" -> 
                    NeuralNetworks`TensorT[{5}, NeuralNetworks`RealT]], 
                  "Outputs" -> 
                  Association[
                   "Output" -> 
                    NeuralNetworks`TensorT[{5}, NeuralNetworks`RealT]]], 
                "trW1" -> Association[
                 "Type" -> "Linear", "Arrays" -> 
                  Association[
                   "Weights" -> NeuralNetworks`Private`DummyRawArray[{1, 5}], 
                    "Biases" -> NeuralNetworks`Private`DummyRawArray[{1}]], 
                  "Parameters" -> 
                  Association[
                   "OutputDimensions" -> {1}, "$OutputSize" -> 1, 
                    "$InputSize" -> 5, "$InputDimensions" -> {5}], "Inputs" -> 
                  Association[
                   "Input" -> 
                    NeuralNetworks`TensorT[{5}, NeuralNetworks`RealT]], 
                  "Outputs" -> 
                  Association[
                   "Output" -> 
                    NeuralNetworks`TensorT[{1}, NeuralNetworks`RealT]]], 
                "trOut" -> 
                Association[
                 "Type" -> "Elementwise", "Arrays" -> Association[], 
                  "Parameters" -> 
                  Association[
                   "Function" -> NeuralNetworks`ValidatedParameter[Ramp], 
                    "$Dimensions" -> {1}], "Inputs" -> 
                  Association[
                   "Input" -> 
                    NeuralNetworks`TensorT[{1}, NeuralNetworks`RealT]], 
                  "Outputs" -> 
                  Association[
                   "Output" -> 
                    NeuralNetworks`TensorT[{1}, NeuralNetworks`RealT]]], 
                "out" -> Association[
                 "Type" -> "Threading", "Arrays" -> Association[], 
                  "Parameters" -> 
                  Association[
                   "Function" -> NeuralNetworks`ValidatedParameter[Plus], 
                    "$Dimensions" -> {1}], "Inputs" -> Association["Input" -> {
                    NeuralNetworks`TensorT[{1}, NeuralNetworks`RealT], 
                    NeuralNetworks`TensorT[{1}, NeuralNetworks`RealT]}], 
                  "Outputs" -> 
                  Association[
                   "Output" -> 
                    NeuralNetworks`TensorT[{1}, NeuralNetworks`RealT]]], 
                "OutW" -> Association[
                 "Type" -> "Linear", "Arrays" -> 
                  Association[
                   "Weights" -> NeuralNetworks`Private`DummyRawArray[{1, 1}], 
                    "Biases" -> NeuralNetworks`Private`DummyRawArray[{1}]], 
                  "Parameters" -> 
                  Association[
                   "OutputDimensions" -> {1}, "$OutputSize" -> 1, 
                    "$InputSize" -> 1, "$InputDimensions" -> {1}], "Inputs" -> 
                  Association[
                   "Input" -> 
                    NeuralNetworks`TensorT[{1}, NeuralNetworks`RealT]], 
                  "Outputs" -> 
                  Association[
                   "Output" -> 
                    NeuralNetworks`TensorT[{1}, NeuralNetworks`RealT]]]]], 
              Alignment -> Center], Nothing]}], 
          GridBoxAlignment -> {"Columns" -> {{Left}}}],
         ImageSizeCache->{858., {147.5, 156.5}},
         TrackedSymbols:>{NeuralNetworks`Private`NetGraph`selection}],
        Initialization:>{NetGraph}],
       BaselinePosition->(Top -> Scaled[3])], "]"}]}],
    False],
   Deploy],
  LineBreakWithin->False]], "Output",
 CellChangeTimes->{{3.747915774836204*^9, 3.7479157881875277`*^9}, {
  3.7479165033756123`*^9, 
  3.747916512562558*^9}},ExpressionUUID->"cf7f1136-a449-436b-8367-\
4140f0f9fe27"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"netRaw", "[", 
  RowBox[{"<|", 
   RowBox[{
    RowBox[{"\"\<throttle\>\"", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2", ",", "3", ",", "4", ",", "5"}], "}"}]}], ",", 
    RowBox[{"\"\<brake\>\"", "\[Rule]", " ", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2", ",", "3", ",", "4", ",", "5"}], "}"}]}]}], 
   "|>"}], "]"}]], "Input",ExpressionUUID->"2c263939-a1ec-4496-9ad0-\
850fa3a695f4"],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{"\<\"acc\"\>", "\[Rule]", 
    RowBox[{"{", "0.5`", "}"}]}], ",", 
   RowBox[{"\<\"acc1\"\>", "\[Rule]", 
    RowBox[{"{", "2.5999999046325684`", "}"}]}]}], 
  "\[RightAssociation]"}]], "Output",
 CellChangeTimes->{
  3.7479165286189423`*^9},ExpressionUUID->"d8d3b34a-a4ff-4d68-a2aa-\
0b7acf4a5efc"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MXNetNetworkExport", "[", 
  RowBox[{"netRaw", ",", "\"\<netTest3\>\""}], "]"}]], "Input",
 CellChangeTimes->{{3.747915797929365*^9, 
  3.747915798031275*^9}},ExpressionUUID->"0e1e39c2-2287-4b34-b6ec-\
8a2191faa2f7"],

Cell[BoxData["\<\"netTest3-0000.params\"\>"], "Output",
 CellChangeTimes->{3.747915799029058*^9, 
  3.747917031750383*^9},ExpressionUUID->"34d19e94-f8ca-4fc4-bacd-\
b71c90bcbf33"]
}, Open  ]]
},
WindowSize->{1858, 1492},
WindowMargins->{{Automatic, 569}, {288, Automatic}},
Magnification:>2. Inherited,
FrontEndVersion->"11.2 for Linux x86 (64-bit) (September 10, 2017)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 232, 5, 94, "Input",ExpressionUUID->"7f264ccd-6af5-4524-92b6-06c9f762a2cd"],
Cell[815, 29, 204, 4, 102, "Output",ExpressionUUID->"c8f5b66e-799d-469a-91dd-b4bae809a666"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1056, 38, 1502, 35, 471, "Input",ExpressionUUID->"7de80479-82aa-42b9-9f44-979d430f65ad"],
Cell[2561, 75, 4315, 94, 280, "Output",ExpressionUUID->"81cafb01-31c3-4593-9ec2-0b2df40bcc1b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[6913, 174, 510, 14, 94, "Input",ExpressionUUID->"ba4d8133-5eb1-4120-8afc-4257c98f0cf8"],
Cell[7426, 190, 268, 7, 102, "Output",ExpressionUUID->"961c4c1d-ef7e-459e-be4e-4a6f557e7410"]
}, Open  ]],
Cell[CellGroupData[{
Cell[7731, 202, 266, 6, 94, "Input",ExpressionUUID->"a8d69a2d-d66a-42dd-9c7d-d9330ce4d24e"],
Cell[8000, 210, 180, 3, 102, "Output",ExpressionUUID->"7403f651-7367-46a2-a978-32a05ab3dffd"]
}, Open  ]],
Cell[CellGroupData[{
Cell[8217, 218, 2946, 68, 894, "Input",ExpressionUUID->"153de193-f99a-4bec-af71-8e49894afc52"],
Cell[11166, 288, 7862, 162, 408, "Output",ExpressionUUID->"f54de7d7-477b-472c-b92e-c28fa3f6c966"]
}, Open  ]],
Cell[CellGroupData[{
Cell[19065, 455, 644, 15, 94, "Input",ExpressionUUID->"875ef99f-65d9-4272-b6ed-6f3dc101224c"],
Cell[19712, 472, 301, 6, 102, "Output",ExpressionUUID->"46cb8886-d3dd-4add-9785-e782909aea77"]
}, Open  ]],
Cell[CellGroupData[{
Cell[20050, 483, 386, 7, 94, "Input",ExpressionUUID->"f4da7ec8-05c9-4ca4-bd42-497b0b6ada1b"],
Cell[20439, 492, 270, 4, 159, "Output",ExpressionUUID->"b5385f61-501f-4649-94a4-86c1a753d488"]
}, Open  ]],
Cell[CellGroupData[{
Cell[20746, 501, 3604, 83, 988, "Input",ExpressionUUID->"35171a95-8286-4f5a-8294-2e78e6f5d951"],
Cell[24353, 586, 9065, 185, 408, "Output",ExpressionUUID->"cf7f1136-a449-436b-8367-4140f0f9fe27"]
}, Open  ]],
Cell[CellGroupData[{
Cell[33455, 776, 429, 11, 94, "Input",ExpressionUUID->"2c263939-a1ec-4496-9ad0-850fa3a695f4"],
Cell[33887, 789, 367, 10, 102, "Output",ExpressionUUID->"d8d3b34a-a4ff-4d68-a2aa-0b7acf4a5efc"]
}, Open  ]],
Cell[CellGroupData[{
Cell[34291, 804, 240, 5, 94, "Input",ExpressionUUID->"0e1e39c2-2287-4b34-b6ec-8a2191faa2f7"],
Cell[34534, 811, 179, 3, 159, "Output",ExpressionUUID->"34d19e94-f8ca-4fc4-bacd-b71c90bcbf33"]
}, Open  ]]
}
]
*)

